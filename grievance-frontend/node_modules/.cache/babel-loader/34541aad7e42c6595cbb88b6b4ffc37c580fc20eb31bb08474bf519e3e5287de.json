{"ast":null,"code":"var _jsxFileName = \"D:\\\\coding\\\\grievance-frontend\\\\src\\\\components\\\\GrievanceForm.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useContext } from 'react';\nimport axios from 'axios';\nimport { useNavigate } from 'react-router-dom';\nimport { AuthContext } from '../context/AuthContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst TRIAGE_DEPT_NAME = 'Grievance Triage';\nconst GrievanceForm = () => {\n  _s();\n  const {\n    authToken,\n    user\n  } = useContext(AuthContext);\n  const [description, setDescription] = useState('');\n  const [department, setDepartment] = useState('');\n  const [category, setCategory] = useState('');\n  const [otherCategoryText, setOtherCategoryText] = useState('');\n  const [departments, setDepartments] = useState([]);\n  const [categories, setCategories] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const navigate = useNavigate();\n\n  // ------------------------\n  // All hooks: always run\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const deptResponse = await axios.get('http://127.0.0.1:8000/api/departments/');\n        setDepartments(deptResponse.data || []);\n        const catResponse = await axios.get('http://127.0.0.1:8000/api/categories/');\n        setCategories(catResponse.data || []);\n      } catch (err) {\n        setError('Failed to load form data. Please refresh the page.');\n      }\n    };\n    fetchData();\n  }, []);\n  useEffect(() => {\n    if (category === 'other') {\n      const triageDept = departments.find(dept => dept.name === TRIAGE_DEPT_NAME);\n      if (triageDept) {\n        setDepartment(triageDept.id);\n      }\n    } else {\n      setDepartment('');\n    }\n  }, [category, departments]);\n  // ------------------------\n\n  // Only after all hooks, do conditional return:\n  if (user !== null && user !== void 0 && user.is_staff) {\n    return /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Admins cannot submit grievances.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 12\n    }, this);\n  }\n\n  // ...rest of your form...\n  // (unchanged)\n};\n_s(GrievanceForm, \"KED2TpIIg0KYysZIrevIx6NNckc=\", false, function () {\n  return [useNavigate];\n});\n_c = GrievanceForm;\nexport default GrievanceForm;\nvar _c;\n$RefreshReg$(_c, \"GrievanceForm\");","map":{"version":3,"names":["React","useState","useEffect","useContext","axios","useNavigate","AuthContext","jsxDEV","_jsxDEV","TRIAGE_DEPT_NAME","GrievanceForm","_s","authToken","user","description","setDescription","department","setDepartment","category","setCategory","otherCategoryText","setOtherCategoryText","departments","setDepartments","categories","setCategories","loading","setLoading","error","setError","navigate","fetchData","deptResponse","get","data","catResponse","err","triageDept","find","dept","name","id","is_staff","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["D:/coding/grievance-frontend/src/components/GrievanceForm.js"],"sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\r\nimport axios from 'axios';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { AuthContext } from '../context/AuthContext';\r\n\r\nconst TRIAGE_DEPT_NAME = 'Grievance Triage';\r\n\r\nconst GrievanceForm = () => {\r\n  const { authToken, user } = useContext(AuthContext);\r\n  const [description, setDescription] = useState('');\r\n  const [department, setDepartment] = useState('');\r\n  const [category, setCategory] = useState('');\r\n  const [otherCategoryText, setOtherCategoryText] = useState('');\r\n  const [departments, setDepartments] = useState([]);\r\n  const [categories, setCategories] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const navigate = useNavigate();\r\n\r\n  // ------------------------\r\n  // All hooks: always run\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        const deptResponse = await axios.get('http://127.0.0.1:8000/api/departments/');\r\n        setDepartments(deptResponse.data || []);\r\n        const catResponse = await axios.get('http://127.0.0.1:8000/api/categories/');\r\n        setCategories(catResponse.data || []);\r\n      } catch (err) {\r\n        setError('Failed to load form data. Please refresh the page.');\r\n      }\r\n    };\r\n    fetchData();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (category === 'other') {\r\n      const triageDept = departments.find(dept => dept.name === TRIAGE_DEPT_NAME);\r\n      if (triageDept) {\r\n        setDepartment(triageDept.id);\r\n      }\r\n    } else {\r\n      setDepartment('');\r\n    }\r\n  }, [category, departments]);\r\n  // ------------------------\r\n\r\n  // Only after all hooks, do conditional return:\r\n  if (user?.is_staff) {\r\n    return <p>Admins cannot submit grievances.</p>;\r\n  }\r\n\r\n  // ...rest of your form...\r\n  // (unchanged)\r\n};\r\n\r\nexport default GrievanceForm;\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,EAAEC,UAAU,QAAQ,OAAO;AAC9D,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,SAASC,WAAW,QAAQ,wBAAwB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAErD,MAAMC,gBAAgB,GAAG,kBAAkB;AAE3C,MAAMC,aAAa,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAC1B,MAAM;IAAEC,SAAS;IAAEC;EAAK,CAAC,GAAGV,UAAU,CAACG,WAAW,CAAC;EACnD,MAAM,CAACQ,WAAW,EAAEC,cAAc,CAAC,GAAGd,QAAQ,CAAC,EAAE,CAAC;EAClD,MAAM,CAACe,UAAU,EAAEC,aAAa,CAAC,GAAGhB,QAAQ,CAAC,EAAE,CAAC;EAChD,MAAM,CAACiB,QAAQ,EAAEC,WAAW,CAAC,GAAGlB,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM,CAACmB,iBAAiB,EAAEC,oBAAoB,CAAC,GAAGpB,QAAQ,CAAC,EAAE,CAAC;EAC9D,MAAM,CAACqB,WAAW,EAAEC,cAAc,CAAC,GAAGtB,QAAQ,CAAC,EAAE,CAAC;EAClD,MAAM,CAACuB,UAAU,EAAEC,aAAa,CAAC,GAAGxB,QAAQ,CAAC,EAAE,CAAC;EAChD,MAAM,CAACyB,OAAO,EAAEC,UAAU,CAAC,GAAG1B,QAAQ,CAAC,KAAK,CAAC;EAC7C,MAAM,CAAC2B,KAAK,EAAEC,QAAQ,CAAC,GAAG5B,QAAQ,CAAC,IAAI,CAAC;EACxC,MAAM6B,QAAQ,GAAGzB,WAAW,CAAC,CAAC;;EAE9B;EACA;EACAH,SAAS,CAAC,MAAM;IACd,MAAM6B,SAAS,GAAG,MAAAA,CAAA,KAAY;MAC5B,IAAI;QACF,MAAMC,YAAY,GAAG,MAAM5B,KAAK,CAAC6B,GAAG,CAAC,wCAAwC,CAAC;QAC9EV,cAAc,CAACS,YAAY,CAACE,IAAI,IAAI,EAAE,CAAC;QACvC,MAAMC,WAAW,GAAG,MAAM/B,KAAK,CAAC6B,GAAG,CAAC,uCAAuC,CAAC;QAC5ER,aAAa,CAACU,WAAW,CAACD,IAAI,IAAI,EAAE,CAAC;MACvC,CAAC,CAAC,OAAOE,GAAG,EAAE;QACZP,QAAQ,CAAC,oDAAoD,CAAC;MAChE;IACF,CAAC;IACDE,SAAS,CAAC,CAAC;EACb,CAAC,EAAE,EAAE,CAAC;EAEN7B,SAAS,CAAC,MAAM;IACd,IAAIgB,QAAQ,KAAK,OAAO,EAAE;MACxB,MAAMmB,UAAU,GAAGf,WAAW,CAACgB,IAAI,CAACC,IAAI,IAAIA,IAAI,CAACC,IAAI,KAAK/B,gBAAgB,CAAC;MAC3E,IAAI4B,UAAU,EAAE;QACdpB,aAAa,CAACoB,UAAU,CAACI,EAAE,CAAC;MAC9B;IACF,CAAC,MAAM;MACLxB,aAAa,CAAC,EAAE,CAAC;IACnB;EACF,CAAC,EAAE,CAACC,QAAQ,EAAEI,WAAW,CAAC,CAAC;EAC3B;;EAEA;EACA,IAAIT,IAAI,aAAJA,IAAI,eAAJA,IAAI,CAAE6B,QAAQ,EAAE;IAClB,oBAAOlC,OAAA;MAAAmC,QAAA,EAAG;IAAgC;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAG,CAAC;EAChD;;EAEA;EACA;AACF,CAAC;AAACpC,EAAA,CA/CID,aAAa;EAAA,QAUAL,WAAW;AAAA;AAAA2C,EAAA,GAVxBtC,aAAa;AAiDnB,eAAeA,aAAa;AAAC,IAAAsC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}